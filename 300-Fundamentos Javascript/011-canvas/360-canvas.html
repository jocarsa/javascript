<!doctype html>
<html lang="es">
    <head>
        <title>Aprendiendo Javascript</title>
        <meta charset="utf-8">
        <style>
            canvas{border:1px solid black;}
        </style>
    </head>
    <body>
        <canvas id="lienzo" width=800 height=400></canvas>
        <script>
            var mijson = {
                "valores":[
                    {"clave":"uno","valor":"15"},
                    {"clave":"dos","valor":"253"},
                    {"clave":"tres","valor":"353"},
                    {"clave":"cuatro","valor":"354"},
                    {"clave":"cinco","valor":"543"},
                    {"clave":"seis","valor":"1345"}
                ]
            }
            console.log(mijson)
            var anchura = 800;
            var altura = 400;
            var lienzo = document.getElementById("lienzo");
            var contexto = lienzo.getContext("2d");
            contexto.fillStyle = "red";
            contexto.fillRect(10,10,20,20);
            var radio = 150;
            var longitudjson = mijson.valores.length
            console.log(longitudjson)
            var suma = 0;
            for(let i = 0;i<longitudjson;i++){
                suma += mijson.valores[i].valor*1
            }
            console.log(suma)
            var ultimaposicion = 0;
            for(let i = 0;i<longitudjson;i++){
                let inicio = ultimaposicion;
                let final = ultimaposicion+(mijson.valores[i].valor/suma)*Math.PI*2;
                ultimaposicion = final
                let rojo = Math.round(Math.random()*255);
                let verde = Math.round(Math.random()*255);
                let azul = Math.round(Math.random()*255);
                contexto.fillStyle = "rgb("+rojo+","+verde+","+azul+")"
                contexto.beginPath();
                contexto.moveTo(anchura/2,altura/2)
                contexto.arc(
                    anchura/2,
                    altura/2,
                    radio,
                    inicio,
                    final
                );
                contexto.lineTo(anchura/2,altura/2);
                contexto.fill();
            }
        </script>
    </body>
</html>